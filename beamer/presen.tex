\documentclass[
    10pt,
    % handout
    ]{sotsu-beamer}

\usepackage{../sotsu-symb}

\usepackage{multicol}

\setmathfont{STIX Two Math}
\setmathfont{XCharterMath}[range=\symscr]

\definecolor{red}{RGB}{255,120,30}
\definecolor{blue}{RGB}{30,120,255}

\newcommand{\upspin}{\mathcolor{red}{\ket{\uparrow}}}
\newcommand{\dwspin}{\mathcolor{blue}{\ket{\downarrow}}}


\begin{document}


\title{デモ}
\date{\number\year 年\number\month 月\number\day 日}


\begin{frame}

    \maketitle

\end{frame}


\section{なぜ線形代数？}


\begin{frame}{量子力学の基本方程式}

    \structure{量子力学の基本方程式}といえば？

    \pause

    \begin{block}{（時間に依存しない）シュレーディンガー方程式}
        \begin{equation}
            \label{eq:time-undependent-Schroedinger-equation}
            \ab[ \frac{\hbar^2}{2m} \ab( \pdv[2]{}{x} + \pdv[2]{}{y} + \pdv[2]{}{z} ) + V(\symbf{r})] \psi(\symbf{r}) = E \psi(\symbf{r})
        \end{equation}
    \end{block}

    \pause
    
    \eqref{eq:time-undependent-Schroedinger-equation}の解を$\psi(\symbf{r}), \xi(\symbf{r})$とすると，
    任意の複素数$a, b$に対して，
    \[  \eta(\symbf{r}) \coloneq a \psi(\symbf{r}) + b \xi(\symbf{r}) 
        \quad \text{（$a, b$は複素数）}  \]
    は\eqref{eq:time-undependent-Schroedinger-equation}の解になっている．

    \pause

    $\implies$\alert{\eqref{eq:time-undependent-Schroedinger-equation}は線型方程式}．

\end{frame}



\begin{frame}
    \label{frame:psi-is-vector}
    \frametitle{数学的には・・・}

    \begin{center}
        方程式\eqref{eq:time-undependent-Schroedinger-equation}の解$\psi(\symbf{r})$全体は，
        \structure{ベクトル空間}をなす．
    \end{center}

\end{frame}


\section{ベクトル空間って？}

\subsection{ベクトル}


\begin{frame}
    \frametitle{ユークリッド空間の例}

    3次元ユークリッド空間$\symbb{R}^3$の縦ベクトル
    \begin{equation*}
        \symbf{x} = 
        \begin{pmatrix}
            x_1 \\ x_2  \\ x_3
        \end{pmatrix}
        \quad
        \text{（$x_1, x_2, x_3$は複素数）}
    \end{equation*}
    とする．

    このとき，
    \begin{equation*}
        a \symbf{x} + b \symbf{y}
        = \begin{pmatrix}
            a x_1 + b y_1  \\
            a x_2 + b y_2  \\
            a x_3 + b y_3
        \end{pmatrix}
    \end{equation*}
    もベクトル．

    \pause

    $\symbf{x}$はある意味\alert{シュレーディンガー方程式の解$\symbf{\psi}$に似ている}．

\end{frame}



\begin{frame}{ベクトル空間の定義}

    ふつうの縦ベクトルについて考えれば当たり前のこと：
    \begin{block}{ベクトル空間の公理}
        集合$V$の元$\symbf{\psi}, \symbf{\varphi}, \symbf{\xi}$を\structure{ベクトル}，
        $a, b, c$を\structure{スカラー}（複素数）とする．
        \begin{enumerate}
            \begin{multicols}{2}
                \item $(\symbf{\psi} + \symbf{\varphi}) + \symbf{\xi} = \symbf{\psi} + (\symbf{\varphi} + \symbf{\xi})$
                \item $\symbf{\psi} + \symbf{0} = \symbf{0} + \symbf{\psi} = \symbf{\psi}$
                \item $\symbf{\psi} + (-\symbf{\psi}) = \symbf{0}$
                \item $\symbf{\psi} + \symbf{\varphi} = \symbf{\varphi} + \symbf{\psi}$
                \item $c (\symbf{\psi} + \symbf{\varphi}) = c \symbf{\psi} + c \symbf{\varphi}$
                \item $(a + b) \symbf{\psi} = a \symbf{\psi} + b \symbf{\psi}$
                \item $(ab) \symbf{\psi} = a(b\symbf{\psi})$
                \item $1 \symbf{\psi} = \symbf{\psi}$
            \end{multicols}
        \end{enumerate}
    \end{block}

    \pause

    \alert{逆に，1--8を満たすすものは，ぜんぶ「\structure{ベクトル}」ということにする}．
    
    このとき，集合$V$を\structure{ベクトル空間}という．
    
    $\implies$\ref{frame:psi-is-vector}ページで考えた$\symbf{\psi}$もベクトル．

\end{frame}


\begin{frame}
    \frametitle{ベクトルの例}

    \begin{itemize}
        \item $N$次の縦ベクトル：$\cvector{a_1 ; a_2 ; \cdots ; a_N}$
        \item $N$次多項式：$p(x) = a_N x^N + a_{N-1} x^{N-1} + \dots + a_1 x + a_0$
        \item 線形方程式の解：$\varphi(x_1, \dots, x_N)$
    \end{itemize}

    

\end{frame}


\subsection{内積}

\begin{frame}
    \frametitle{ユークリッド内積}

    縦ベクトルがもっている重要な性質：\structure{内積}の復習．

    \begin{block}{縦ベクトルの内積}
        $\symbf{x}, \symbf{y}$：$N$次元ベクトル
        \begin{equation}
            \label{eq:Euclid-inner-product}
            \iparen{\symbf{x}, \symbf{y}}
                \coloneq \sum_{i=1}^{N} x_i^* y_i
        \end{equation}
        を\structure{内積}という．
    \end{block}

    ベクトルの長さ（\structure{ノルム}）は，
    \begin{equation}
        \label{eq:Euclid-norm}
        \norm{\symbf{x}} \coloneq \sqrt{\iparen{\symbf{x}, \symbf{x}}}
    \end{equation}

    \begin{alertblock}{注意}
        \eqref{eq:Euclid-norm}の右辺の$\sqrt{\quad}$の中身$\geq 0$になるように，
        \eqref{eq:Euclid-inner-product}の$x_i$を複素共役にしてある．
    \end{alertblock}

\end{frame}

\begin{frame}
    \frametitle{内積の定義}

    \only<1>{
        \eqref{eq:Euclid-inner-product}は次の性質を満たす．
    }

    \begin{block}{内積の公理}
        ベクトル$\symbf{\psi}, \symbf{\varphi}, \symbf{\xi}$と
        スカラー（複素数）$a, b$について
        \begin{enumerate}
            \item $\iparen{\symbf{\psi}, \  a\symbf{\varphi} + b\symbf{\xi}} = a\iparen{\symbf{\psi}, \symbf{\xi}} + b\iparen{\symbf{\psi}, \symbf{\varphi}}$（\structure{線形性}）
            \item $\iparen{\symbf{\psi}, \symbf{\varphi}} = \conj{\iparen{\symbf{\varphi}, \symbf{\psi}}}$
            \item $\iparen{\symbf{\psi}, \symbf{\psi}} \geq 0$であり，
                $\iparen{\symbf{\psi}, \symbf{\psi}} = 0 \iff \symbf{\psi} = \symbf{0}$（\structure{正定値性}）
        \end{enumerate}
    \end{block}

    \pause

    上の条件を満たす計算$\iparen{\bigdot, \bigdot}$を改めて「\structure{内積}」と呼ぶことにする．

    内積をもつベクトル空間を，\structure{内積空間}と呼ぶ．

    \pause

    \begin{alertblock}{注意}
        1と2をあわせると，
        $\iparen{a\symbf{\psi} + b\symbf{\varphi}, \  \symbf{\xi}} = \conj{a}\iparen{\symbf{\psi}, \symbf{\xi}} + \conj{b}\iparen{\symbf{\varphi}, \symbf{\xi}}$（\structure{反線形性}）である．
    \end{alertblock}


\end{frame}

\begin{frame}
    \frametitle{関数の内積}

    シュレーディンガー方程式の解はベクトル．

    では，関数$\psi(\symbf{r})$と$\xi(\symbf{r})$の内積は？

    \pause

    \begin{equation}
        \iparen{\psi, \xi}
            \coloneq \iiint \conj{\psi}(\symbf{r}) \, \xi(\symbf{r}) \dd{\symbf{r}}
    \end{equation}
    とすれば，前のページの性質を満たす．

\end{frame}


\subsection{基底}

\begin{frame}
    \frametitle{ユークリッド空間の基底}

    すべての縦ベクトル$\symbf{x} = \cvector{x_1 ; x_2 ; x_3}$は，
    \begin{equation}
        \label{eq:Euclidean-basis}
        \symbf{e}_1 = \begin{pmatrix} 1 \\ 0 \\ 0 \end{pmatrix}, \quad 
        \symbf{e}_2 = \begin{pmatrix} 0 \\ 1 \\ 0 \end{pmatrix}, \quad 
        \symbf{e}_3 = \begin{pmatrix} 0 \\ 0 \\ 1 \end{pmatrix}
    \end{equation}
    を使って，
    \begin{equation*}
        \symbf{x} = x_1 \symbf{e}_1 + x_2 \symbf{e}_2 + x_3 \symbf{e}_3
    \end{equation*}
    と書ける．

    さらに，\eqref{eq:Euclidean-basis}は\structure{一次独立}：
    \begin{equation*}
        x_1 \symbf{e}_1 + x_2 \symbf{e}_2 + x_3 \symbf{e}_3 = \symbf{0}
        \iff
        x_1 = x_2 = x_3 = 0
    \end{equation*}

\end{frame}


\begin{frame}
    \frametitle{ベクトル空間の基底}

    同じように，ベクトル空間$V$の\alert{すべてのベクトル}$\symbf{\psi}$は，
    \structure{一次独立}なベクトル$\symbf{\varphi}_1, \symbf{\varphi}_2, \dotsc$を使って
    \begin{equation}
        \label{eq:basis}
        \symbf{\varphi} = \sum_i c_i \symbf{\varphi}_i
        \quad \text{（$c_i$は複素数）}
    \end{equation}
    と書ける．
    \pause
    $\symbf{\varphi}_i$：$V$の\alert{基底}という．

\end{frame}


\begin{frame}
    \frametitle{ベクトル空間の次元}

    \eqref{eq:basis}を満たす一次独立なベクトルの組$\symbf{\chi}_i$は，
    いくつも存在している．

    例えば，ユークリッド空間では，\eqref{eq:Euclidean-basis}のかわりに
    \begin{equation*}
        \symbf{e}'_1 = \cvector{1 ; 1 ; 0}, \quad 
        \symbf{e}'_2 = \cvector{1 ; {-1} ; 0}, \quad
        \symbf{e}'_3 = \cvector{0 ; 0 ; \sqrt{2}}
    \end{equation*}
    としてもよい．

    しかし，$\symbf{\chi}_1, \symbf{\chi}_2, \dotsc$の数は同じ（上の例だと，必ず3つ）．

    ベクトル空間がもつ基底の数を\alert{次元}という．


\end{frame}


\subsection{同型}


\begin{frame}
    \frametitle{同型（どうけい）とは}

    ベクトル空間の定義に出てくるのは3つだけ：
    \begin{itemize}
        \item ベクトル（$\symbf{\psi}, \symbf{\xi}, \dotsc$）
        \item ベクトルの和（$+$）
        \item スカラー倍（$\cdotp$）
    \end{itemize}

    \pause

    よって，
    \begin{itemize}
        \item ベクトルの\structure{かず}が同じ
        \item \structure{線形構造}（和とスカラー倍）が同じ
    \end{itemize}
    である2つのベクトル空間は，同じものと見なしてもよい．
    
\end{frame}


\begin{frame}[allowframebreaks]
    \frametitle{同型の例}

    2次多項式$a_2 x^2 + a_1 x + a_0$のベクトル空間$\symbb{R}[x]_2$は，
    3次元縦ベクトルの空間$\symbb{R}^3$と同型．

    対応
    \begin{align*}
        p(x) = a_2 x^2 + a_1 x + a_0
        &\leftrightarrow \text{縦ベクトル} \, \cvector{a_2 ; a_1 ; a_0} = \symbf{a}
        \\
        q(x) = b_2 x^2 + b_1 x + b_0
        &\leftrightarrow \text{縦ベクトル} \, \cvector{b_2 ; b_1 ; b_0} = \symbf{b}
    \end{align*}
    とすれば，
    \begin{align*}
        p + q \leftrightarrow \symbf{a} + \symbf{b},
        \quad
        c \cdotp p \leftrightarrow c \symbf{a} \, \text{（$c$：複素数）}
    \end{align*}
    線形演算がまったく同じ．


    \framebreak

    実は，基底の対応
    \begin{equation*}
        x^2 \leftrightarrow \begin{pmatrix} 1 \\ 0 \\ 0 \end{pmatrix},
        \quad 
        x \leftrightarrow \begin{pmatrix} 0 \\ 1 \\ 0 \end{pmatrix},
        \quad 
        1 \leftrightarrow \begin{pmatrix} 0 \\ 0 \\ 1 \end{pmatrix},
    \end{equation*}
    を定めるだけで，対応$a_2 x^2 + a_1 x + a_0 \leftrightarrow (a_2 \,\, a_1 \,\, a_0)$が決まる．

\end{frame}


\begin{frame}
    \frametitle{$N$次元ベクトル空間どうしは同型}

    \begin{block}{定理}
        2つの$N$次元ベクトル空間は同型である．
    \end{block}

    2つのベクトル空間の基底$\{\symbf{\varphi}_i\}, \{\symbf{\varphi}'_i\}$をそれぞれ
    \begin{align*}
        \symbf{\varphi}_1 &\leftrightarrow \symbf{\varphi}'_1, 
        \quad
        \cdots, 
        \quad
        \symbf{\varphi}_N \leftrightarrow \symbf{\varphi}'_N
    \end{align*}
    のように対応させれば簡単に証明できる．

    \pause 

    \begin{alertblock}{同型の意味}
        結局，\structure{$N$次元ベクトル空間は実質1つだけ！}
    \end{alertblock}

    $\implies$一番簡単な$\symbb{C}^N$を考えればよい．

\end{frame}


\subsection{表現行列}


\begin{frame}
    \frametitle{表現行列}

    多項式関数$f(x) = a_2 x^2 + a_1 x + a_0$を微分する演算子：$\hat{D} \coloneq \dv{}{x}$．

    もちろん，
    \begin{equation*}
        (\hat{D} f) (x) = \dv{f}{x} = 2 a_2 x + a_1
    \end{equation*}

    \pause

    ところで，対応$f \leftrightarrow (a_2 \,\, a_1 \,\, a_0)$を考えると，
    これは
    \begin{equation*}
        (\hat{D} f)
        \leftrightarrow
        \begin{pmatrix}
            0  \\  2 a_2  \\  a_1
        \end{pmatrix}
        =
        \underbrace{
        \begin{pmatrix}
            0  &  0  &  0  \\
            2  &  0  &  0  \\
            0  &  1  &  0
        \end{pmatrix}
        }_{\text{\normalsize$\symsf{D}$}}
        \begin{pmatrix}
            a_2  \\  a_1  \\  a_0
        \end{pmatrix}
        \leftrightarrow
        f
    \end{equation*}
    と行列の計算としてかける．

    \pause

    $\symsf{D}$を\alert{表現行列}という．

\end{frame}



\section{スピン系}

\begin{frame}
    \frametitle{スピン}

    1粒子のスピンは，
    $\upspin$：アップスピン，
    $\dwspin$：ダウンスピンの2次元．

    \pause

    よって，$\symbb{R}^2$と同型，
    具体的には
    \begin{equation*}
        \upspin \leftrightarrow (1 \,\, 0),
        \quad 
        \dwspin \leftrightarrow (0 \,\, 1)
    \end{equation*}
    と対応させられる．

    \pause

    スピンの重ね合わせ：
    \[  a \upspin + b \dwspin \leftrightarrow 
    \begin{pmatrix}
        a  \\  b
    \end{pmatrix}  \]
    と簡潔に表現できる．

\end{frame}


\begin{frame}
    \frametitle{スピンに作用する演算子}

    スピンに作用する演算子：
    \begin{itemize}
        \item $\hat{S}_+$……$\hat{S}_+ \upspin = \symbf{0}$，$\hat{S}_+ \dwspin = \upspin$
        \item $\hat{S}_-$……$\hat{S}_- \upspin = \dwspin$，$\hat{S}_+ \dwspin = \symbf{0}$
        \item $\hat{S}_z$……$\hat{S}_z \upspin = \frac{1}{2} \upspin$，$\hat{S}_z \dwspin = \frac{1}{2} \dwspin$
    \end{itemize}

    \pause

    行列を使えば，
    \begin{alignat*}{3}
        % S_+
        \hat{S}_+ &\colon 
        &
        \begin{pmatrix}
            0 & 1 \\
            0 & 0
        \end{pmatrix}
        \mathcolor{red}{ \begin{pmatrix} 1 \\ 0 \end{pmatrix} }
        &= 
        \mathcolor{black}{ \begin{pmatrix} 0 \\ 0 \end{pmatrix} }
        , \quad
        &
        \begin{pmatrix}
            0 & 1 \\
            0 & 0
        \end{pmatrix}
        \mathcolor{blue}{ \begin{pmatrix} 0 \\ 1 \end{pmatrix} }
        &= 
        \mathcolor{red}{ \begin{pmatrix} 1 \\ 0 \end{pmatrix} }
        \\
        %
        % S_-
        % 
        \hat{S}_- &\colon 
        &
        \begin{pmatrix}
            0 & 0 \\
            1 & 0
        \end{pmatrix}
        \mathcolor{red}{ \begin{pmatrix} 1 \\ 0 \end{pmatrix} }
        &= 
        \mathcolor{blue}{ \begin{pmatrix} 0 \\ 1 \end{pmatrix} }
        , \quad
        &
        \begin{pmatrix}
            0 & 0 \\
            1 & 0
        \end{pmatrix}
        \mathcolor{blue}{ \begin{pmatrix} 0 \\ 1 \end{pmatrix} }
        &= 
        \mathcolor{black}{ \begin{pmatrix} 0 \\ 0 \end{pmatrix} }
        \\
        %
        % S_z
        %
        \hat{S}_z &\colon 
        &
        \begin{pmatrix}
            \frac{1}{2} & 0 \\
            0 & \frac{1}{2}
        \end{pmatrix}
        \mathcolor{red}{ \begin{pmatrix} 1 \\ 0 \end{pmatrix} }
        &= 
        \frac{1}{2}
        \mathcolor{red}{ \begin{pmatrix} 1 \\ 0 \end{pmatrix} }
        , \quad
        &
        \begin{pmatrix}
            \frac{1}{2} & 0 \\
            0 & \frac{1}{2}
        \end{pmatrix}
        \mathcolor{blue}{ \begin{pmatrix} 0 \\ 1 \end{pmatrix} }
        &= 
        \frac{1}{2}
        \mathcolor{blue}{ \begin{pmatrix} 0 \\ 1 \end{pmatrix} }
    \end{alignat*}
    

\end{frame}



\begin{frame}
    \frametitle{多粒子系の扱い方：テンソル積}

    $\ket{\psi} = \cvector{a ; b}$, $\ket{\xi} = \cvector{c ; d}$とする．

    2状態をあわせた$\ket{\psi}\ket{\xi}$はどう表現する？

    \pause

    答え：\alert{テンソル積}
    \begin{equation}
        \ket{\psi} \otimes \ket{\xi}
            \coloneq \begin{pmatrix}
                a \ket{\xi}  \\  b \ket{\xi}
            \end{pmatrix}
            = \begin{pmatrix}
                ac \\ ad \\ bc \\ bd
            \end{pmatrix}
    \end{equation}

    \pause

    3つ以上のテンソル積も，
    $\ket{\psi} \otimes \bigl( \ket{\xi} \otimes \ket{\xi} \bigr)$のようにして定義できる．

\end{frame}


\begin{frame}
    \frametitle{行列のテンソル積}

    行列のテンソル積も，
    \begin{equation*}
        \begin{pmatrix}
            a & b \\ c & d
        \end{pmatrix}
        \otimes 
        \underbrace{
        \begin{pmatrix}
            \alpha & \beta \\ \gamma & \delta
        \end{pmatrix}
        }_{\text{\normalsize$\symsf{B}$}}
        = 
        \begin{pmatrix}
            a \symsf{B} & b \symsf{B} \\
            c \symsf{B} & d \symsf{B}
        \end{pmatrix}
        =
        \begin{pmatrix}
            a\alpha & a\beta & b\alpha & b\beta \\
            a\gamma & a\delta & b\gamma & b\delta \\
            c\alpha & c\beta & d\alpha & d\beta \\
            c\gamma & c\delta & d\gamma & d\delta
        \end{pmatrix}
    \end{equation*}

    さらに，2スピン系$\ket{\psi} \otimes \ket{\varphi}$に作用する演算子は，
    それぞれのスピンに作用する演算子$\symcal{O}_1, \symcal{O}_2$を使うと
    \begin{equation*}
        \ab(\hat{\symcal{O}}_1 \otimes \hat{\symcal{O}}_2)
        \ab(\ket{\psi} \otimes \ket{\varphi})
        = \hat{\symcal{O}}_1 \ket{\psi}
          \otimes
          \hat{\symcal{O}}_2 \ket{\varphi}
    \end{equation*}

\end{frame}



\section{測定とは？}

\begin{frame}
    \frametitle{オブザーバブルと固有値分解}

    観測可能な物理量：\alert{オブザーバブル}という．

    オブザーバブルには，対応する\alert{エルミート行列}$A$が存在．

    \pause 

    $\hat{A}$の固有ベクトル$\ket{\varphi_1}, \dots, \ket{\varphi_N}$（固有値$a_1, \dots, a_N$：重複あり）を使うと，
    \begin{equation}
        \hat{A} = \sum_{i = 1}^{N} a_i \ketbra{\varphi_i}{\varphi_i}
    \end{equation}
    これを\alert{固有値分解}という．

\end{frame}


\begin{frame}
    \frametitle{スペクトル分解}

    \begin{itemize}
        \item \structure{相異なる}固有値$a_{(1)}, \dots, a_{(n)}$
        \item 固有値$a_i$に属する固有ベクトル$\ket{\varphi_{a_{(i)}, 1}}, \dots, \ket{\varphi_{a_{(i)}, m_i}}$
    \end{itemize}

    固有値$a_i$に対応する固有空間への\alert{射影}：
    \begin{equation*}
        \hat{P}_{a_i} = \sum_{k = 1}^{m_i} \ketbra{\varphi_{a_{(i)}, k}}{\varphi_{a_{(i)}, k}}
    \end{equation*}

    固有値分解を書き直す：
    \begin{equation}
        \hat{A} = \sum_{i = 1}^{m_i} a_{(i)} \hat{P}_{a_{(i)}}
    \end{equation}
    これを\alert{スペクトル分解}という．

\end{frame}


\begin{frame}
    \frametitle{オブザーバブルの測定}

    \begin{itemize}
        \item オブザーバブルに対応するエルミート行列$\hat{A}$
        \item $\hat{A}$の固有値$a_{(1)}, \dots, a_{(n)}$
        \item 固有値$a_{(i)}$に対応する固有空間への射影$\hat{P}_{a_{(i)}}$
    \end{itemize}

    状態$\ket{\psi}$に対し，このオブザーバブルを測定したときの値は？

    \pause 

    \begin{block}{$\ket{\psi}$の観測により得られる値}
        確率
        \begin{equation}
            \label{eq:proposition-of-observable}
            \braket{\psi}{\hat{P}_{a_{(i)}} \psi}
        \end{equation}
        で固有値$a_{(i)}$を観測する．
    \end{block}

\end{frame}


\begin{frame}
    \frametitle{オブザーバブルの測定（つづき）}

    \begin{alertblock}{確率の規格化は？}
        \eqref{eq:proposition-of-observable}で全確率は$1$になっている？
        \begin{equation*}
            \sum_{i = 1}^{n} \braket{\psi}{\hat{P}_{a_{(i)}} \psi} = 1
        \end{equation*}
        これは，固有ベクトル系$\ket{\varphi_i}$が完全であることから
        \begin{equation*}
            \sum_{i = 1}^{n} \hat{P}_{a_{(i)}} = \idop
        \end{equation*}
        であることを使うと成立．
    \end{alertblock}

\end{frame}




\end{document}