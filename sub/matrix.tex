\documentclass[../sotsu.tex]{subfiles}

\begin{document}


\section{行列}
\label{sec:matrix}

この章では行列の性質を述べる．

\subsection{行列の定義}

\begin{definition}[行列]
    $𝕂$を\refdfn[体]{dfn:field}とする．
    $𝕂$の元（すなわち数字）を縦横に$m \times n$個ならべたものを\word{行列}[ぎょう|れつ][きようれつ](matrix)という．
    \begin{equation}
        \label{eq:matrix-example}
        A \coloneq 
        \begin{pmatrix}
            a_{11}  &  a_{12}  &  \cdots  &  a_{1n}  \\
            a_{21}  &  a_{22}  &  \cdots  &  a_{2n}  \\
            \vdots  &  \vdots  &  \ddots  &  \vdots  \\
            a_{m1}  &  a_{m2}  &  \cdots  &  a_{mn}
        \end{pmatrix}
        , \qquad 
        a_{ij} \in 𝕂
    \end{equation}
    縦が\word{列}[れつ]，横が\word{行}[ぎょう]である．

    \cref{eq:matrix-example}において，
    上から$i$番目，左から$j$番目にある数字$a_{ij}$のことを，
    $A$の$(i, j)$-成分という．
    これを$(A)_{ij}$とかくこともある．
\end{definition}

\cref{eq:matrix-example}の行列$A$を，$(a_{ij})_{1 \leq i \leq m, \  1 \leq j \leq n}$とあらわすこともある．

\begin{definition}
    \label{dfn:set-of-matrix}
    $𝕂$-係数の$m \times n$-行列全体の集合を$M_{mn}(𝕂)$とあらわす．
\end{definition}

名前がついている特別な行列がいくつかある．

\begin{definition}
    すべての成分が$0$\footnote{
        $0$とは\refdfn-[体]{dfn:field}$\symbb{K}$上で定義された加法に関する単位元のこと．
    }である行列を\word{零行列}という．
    \begin{equation}
        \zmat \coloneq 
        \begin{pmatrix}
            0      & 0      & \cdots & 0      \\
            \vdots & \vdots & \ddots & \vdots \\
            0      & 0      & \cdots & 0
        \end{pmatrix}
    \end{equation}
\end{definition}

\begin{definition}[正方行列]
    行と列の数が同じ行列，すなわち$n \times n$-行列を\word{正方行列}[せい|ほう|ぎょう|れつ]という．
    特に大きさを明示する場合，$n$-\ruby{次}{じ}正方行列という．
\end{definition}


\begin{definition}
    正方行列のなかで，$(i, i)$-成分が$1$，それ以外が$0$である行列
    \begin{equation}
        \umat \coloneq 
        \begin{pmatrix}
            1  &  0  &  \cdots  &  0  \\
            0  &  1  &  \cdots  &  0  \\
            \vdots & \vdots & \ddots & \vdots \\
            0  &  0  &  \cdots  &  1  
        \end{pmatrix}
    \end{equation}
    を\word{単位行列}[たん|い|ぎょう|れつ]という．
\end{definition}


\begin{definition}
    \label{dfn:inverse-of-matrix}
    $A$を$n$-次正方行列とする．
    \begin{equation}
        A A^{-1} = A^{-1} A = \umat
    \end{equation}
    となるような$n$-次正方行列$A^{-1}$が存在するとき，
    $A^{-1}$を$A$の\word{逆行列}という．
\end{definition}


\begin{theorem}
    $n \times n$-正方行列$A, B$について，
    $AB = \umat$ならば$BA = \umat$である．
    したがって，$A^{-1}$が$A$の逆行列であることを確かめるには，
    $A A^{-1} = \umat$または$A^{-1} A = \umat$のどちらか片方を確認すればよい．
\end{theorem}




\begin{definition}
    行列の和・倍・積を以下のように定義する．
    \begin{enumerate}
        \item 2つの$m \times n$行列$A = (a_{ij})$，$B = (b_{ij})$の和は，それぞれの成分の和
            \begin{equation}
                A + B \coloneq (a_{ij} + b_{ij})_{1 \leq i \leq m, \  1 \leq j \leq n}
            \end{equation}
        \item 行列$A = (a_{ij})$の$c$（$\in 𝕂$）倍は，それぞれの成分の$c$倍
            \begin{equation}
                c \cdotp A \coloneq (c \cdotp a_{ij})_{1 \leq i \leq m, \  1 \leq j \leq n}
            \end{equation}
        \item $m \times n$行列$A = (a_{ij})$，$n \times l$行列$B = (b_{jk})$の積は
            \begin{equation}
                A \cdotp B \coloneq \ab( \sum_{1 \leq j \leq n} a_{ij} \cdotp b_{jk} )_{1 \leq i \leq m, \  1 \leq k \leq l}
            \end{equation}
    \end{enumerate}
\end{definition}


\begin{proposition}
    \label{thm:matrix-operation}
    行列の演算についての性質を挙げる．
    $m \times n$-行列$\zmat$を零行列，
    $p \times p$-行列$\umat$，$q \times q$-行列$\umat'$を単位行列とする．
    \begin{itemize}
        \item $M_{mn}(𝕂)$は和について\refdfn[アーベル群]{dfn:group}をなす．
            すなわち，$m \times n$行列-$A, B, C$に対し，
        \begin{enumerate}
            \item （結合律）$(A + B) + C = A + (B + C)$であり，
            \item （単位元）$A + \zmat = \zmat + A = A$であり，
            \item （逆元）$A + (-A) = (-A) + A$となる$-A$が存在し，
            \item （交換律）$A + B = B + A$である．
        \end{enumerate}
        \item 行列は積について結合的であり，また単位元をもつ．
            すなわち，$p \times q$-行列$A$，$q \times r$-行列$B$，$r \times s$-行列$C$に対し，
        \begin{enumerate}[resume]
            \item \label{matrix:product-associative}（結合律）
                $(AB)C = A(BC)$であり，
            \item （単位元）$A \umat = \umat A = A$である．
        \end{enumerate}
        \item さらに，$p \times q$-行列$A, B$，$q \times r$-行列$C, D$に対し，
        \begin{enumerate}[resume]
            \item （分配律）$(A + B)C = AB + AC$，$A(C + D) = AC + AD$
        \end{enumerate}
    \end{itemize}
\end{proposition}


\subsection{数ベクトル}
\label{sec:coordinate-space}

$m \times 1$-行列のことを数ベクトルという．
数ベクトルの幾何的な意味については\cref{sec:Euclidean-vector-intro}で扱うが，
ここでは代数的な性質に重点をおく．

\begin{definition}
    \label{dfn:canonical-basis-of-coordinate-space}
    $\symbb{K}^m$の元のなかで，
    第$i$行の成分のみが$1$，
    ほかの成分が$0$であるもの
    \begin{equation*}
        \symbf{e}_i
            \coloneq
            \begin{pmatrix}
                0  \\  \vdots  \\  1  \\  \vdots  \\  0
            \end{pmatrix}
    \end{equation*}
    をあつめたもの
    \begin{equation*}
        \{  \symbf{e}_1, \dots, \symbf{e}_m  \}
    \end{equation*}
    を，$\symbb{K}^m$の\word{標準基底}(canonical basis)という．
\end{definition}

$l \times m$-行列$A$と数ベクトル$\symbf{x} \in \symbb{K}^l$の行列としての積を計算すると，
$A\symbf{x} \in \symbb{K}^l$である．
したがって，$l \times m$-行列は$\symbb{K}^m$から$\symbb{K}^l$への\refdfn-[写像]{dfn:map}と見ることができる．
これが\cref{sec:linear-map}で扱う線形写像の第一歩である．

合成写像のようなものを考えることもできる．

\begin{corollary}
    \label{thm:composition-of-transformation-of-Euclidean-vector}
    $\symbf{x} \in \symbb{K}^m$とする．
    $k \times l$-行列$A$，$l \times m$-行列$B$に対し，
    $A(B\symbf{x}) = (AB)\symbf{x}$である．
\end{corollary}

\begin{proof}
    \cref{thm:matrix-operation}の\cref{matrix:product-associative}の特別な場合である．
\end{proof}



\subsection{置換}

\begin{definition}
    \label{dfn:permutation}
    集合$\{ 1, 2, \dots, n \}$から自身への\refdfn[写像]{dfn:map}のうち\refdfn-[全単射]{dfn:bijection}であるものを，
    $n$-文字の\word{置換}[ち|かん][ちかん]という．
    それぞれの元を$1 \mapsto \sigma(1), \  2 \mapsto \sigma(2), \  \dotsc$とうつすものを
    \begin{equation*}
        \sigma = 
        \begin{pmatrix}
                   1  &        2  & \cdots &        n  \\
            \sigma(1) & \sigma(2) & \cdots & \sigma(n)
        \end{pmatrix}
    \end{equation*}
    とかく．
    $n$文字の置換$\sigma$全体がなす集合を$\symfrak{S}_n$とかく．
\end{definition}

\begin{definition}
    \label{dfn:identity-permutation}
    置換$\sigma$のうち\refdfn-[恒等写像]{dfn:identity-map}であるものを\word{恒等置換}という．   
\end{definition}

\begin{definition}
    \label{dfn:inverse-of-permutation}
    置換$\sigma$の\refdfn-[逆写像]{dfn:inverse-map}$\sigma^{-1}$を\word{逆置換}という．
\end{definition}

任意の置換$\sigma \in \symfrak{S}_n$は全単射であるから，
逆置換$\sigma^{-1} \in \symfrak{S}_n$が必ず存在する．

\begin{definition}[置換の積]
    \label{dfn:product-of-permutation}
    $\sigma, \tau \in \symfrak{S}_n$とする．
    2つの置換の積$\sigma\tau$を，写像の合成$\sigma \circ \tau$として定める．
\end{definition}

なお，一般に置換の積は交換しない（$\sigma \tau \neq \tau \sigma$）．

この記法を用いると，
任意の置換$\sigma \in \symfrak{S}_n$とその逆置換$\sigma^{-1}$について，
$\sigma \sigma^{-1} = \sigma^{-1} \sigma = \text{恒等置換}$である．

\begin{proposition}
    $n$-文字の置換全体の集合$\symfrak{S}_n$は，
    \cref{dfn:product-of-permutation}で定義される積に対して群をなす．
\end{proposition}

\begin{proof}
    結合律は\refdfn[写像の合成が結合的である]{thm:map-is-associative}ことよりいえる．
    単位元は\refdfn-[恒等置換]{dfn:identity-permutation}，
    逆元は\refdfn-[逆置換]{dfn:inverse-of-permutation}である．
\end{proof}

\begin{definition}
    \label{dfn:transposition}
    置換$\sigma \in \symfrak{S}_n$のうち，
    $\sigma(i) \neq i$となる$i$が2つだけのもの，
    つまり2つの数字を入れ替えるだけの置換を\word{互換}[ご|かん][こかん](transposition)という．
\end{definition}

\begin{proposition}
    任意の置換は互換の積としてあらわされる．
\end{proposition}

置換に対し，互換の積によるあらわしかたは一意ではない．
しかし，次のような事実が成立する．

\begin{proposition}
    \label{thm:parity-of-permutation}
    任意の置換を互換に分解したとき，含まれる互換の数の偶奇は積のあらわしかたによらない．
\end{proposition}

証明は複雑なため省略するが，
これによって次に示す$\sgn$の定義を正当化される．

\begin{definition}
    \label{dfn:sign-of-permutation}
    置換$\sigma$を互換による積であらわしたとき，
    互換が奇数個なら$\sgn(\sigma) = -1$，偶数個なら$\sgn(\sigma) = +1$となるように
    $\sgn \colon \symfrak{S}_n \to \{ +1, -1 \}$を定義する．
    これを置換の\word{符号}[ふ|ごう][ふこう](sign)という．
\end{definition}

$\sgn(\sigma)$のことを$(-1)^\sigma$や$(-)^\sigma$とかくこともある．

\begin{corollary}
    \label{thm:sign-of-product-of-permutation}
    \label{thm:sign-of-inverse-of-permutation}
    任意の置換$\sigma, \tau \in \symfrak{S}_n$について，
    $\sgn(\sigma \tau) = \sgn \sigma \cdotp \sgn \tau$である．
    特に，$\sgn(\sigma^{-1}) = \sgn(\sigma)$である．
\end{corollary}

\begin{proof}
    前半は$\sigma$，$\tau$をそれぞれ互換の積であらわせば明らか．
    後半は$\sgn(\sigma) \cdotp \sgn(\sigma^{-1}) = \sgn(\sigma \cdotp \sigma^{-1}) = \sgn(\text{恒等置換}) = 1$であることからわかる．
\end{proof}



\subsection{行列式}

\begin{definition}
    $n$-次の正方行列$A = (a_{ij})$に対して，
    \begin{equation}
        \det A  \coloneq  \sum_{\sigma \in \symfrak{S}_n} \sgn(\sigma) \, a_{1, \sigma(1)} a_{2, \sigma(2)} \dotsm a_{n, \sigma(n)} 
    \end{equation}
    で定義される写像$\det \colon M_{nn}(𝕂) \to 𝕂$を\word{行列式}[ぎょう|れつ|しき][きようれつしき](determinant)という．
\end{definition}

\begin{proposition}
    $A$を$n$-次正方行列とする．
    行列式について，以下が成り立つ．
    \begin{enumerate}
        \item $\det A = \det \tp{A}$
        \item $\det (cA) = c^n \det A$
    \end{enumerate}
\end{proposition}

\begin{proof}
    \begin{enumerate}
        \item $\tp{A}$の行列式は
            \[  \det \tp{A} = \sum_{\sigma \in \symfrak{S}_n} \sgn(\sigma) \, a_{\sigma(1), 1} a_{\sigma(2), 2} \dotsm a_{\sigma(n), n}  \]
            であるが，$\sigma(i)$が連番になるように$a_{\sigma(i), i}$の順番を入れ替えることで，
            \[  \det \tp{A} = \sum_{\sigma^{-1} \in \symfrak{S}_n} \sgn(\sigma^{-1}) \, a_{1, \sigma^{-1}(1)} a_{2, \sigma^{-1}(2)} \dotsm a_{n, \sigma^{-1}(n)}  \]
            と書き換えられ，
            \cref{thm:sign-of-inverse-of-permutation}より$\sgn(\sigma) = \sgn(\sigma^{-1})$であることから従う．
        \item 行列式の定義より明らかである．
    \end{enumerate}
\end{proof}

\begin{definition}
    \label{dfn:invertible-matrix}
    正方行列$A$に対し，\refdfn-[逆行列]{dfn:inverse-of-matrix}$A^{-1}$が存在するとき，
    $A$を\word{正則行列}[せい|そく|ぎょう|れつ][せいそくきようれつ](invertible matrix)という．
\end{definition}

\begin{proposition}
    以下は同値．
    \begin{enumerate}
        \item $A$は正則行列．
        \item $A$の行列式$\det A = 0$．
        \item $A 𝒙 = \symbf{0}$の解は自明な解$𝒙 = \symbf{0}$のみである．
    \end{enumerate}
\end{proposition}



\end{document}